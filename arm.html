<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>ARM - PoE Format Specification</title>
        
        


        <!-- Custom HTML head -->
        


        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        
        <link rel="icon" href="favicon.svg">
        
        
        <link rel="shortcut icon" href="favicon.png">
        
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        
        <link rel="stylesheet" href="fonts/fonts.css">
        

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        

        
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="introduction.html"><strong aria-hidden="true">1.</strong> Introduction</a></li><li class="chapter-item expanded "><a href="bundles.html"><strong aria-hidden="true">2.</strong> Bundles</a></li><li class="chapter-item expanded "><a href="ggpk.html"><strong aria-hidden="true">3.</strong> GGPK (legacy)</a></li><li class="chapter-item expanded "><a href="arm.html" class="active"><strong aria-hidden="true">4.</strong> ARM</a></li><li class="chapter-item expanded "><a href="ao-aoc.html"><strong aria-hidden="true">5.</strong> AO/AOC</a></li><li class="chapter-item expanded "><a href="smd.html"><strong aria-hidden="true">6.</strong> SMD</a></li><li class="chapter-item expanded "><a href="area-generation.html"><strong aria-hidden="true">7.</strong> Notes on Area Generation</a></li><li class="chapter-item expanded "><a href="meshes.html"><strong aria-hidden="true">8.</strong> Notes on Meshes</a></li><li class="chapter-item expanded "><a href="extensions.html"><strong aria-hidden="true">9.</strong> Index of File Extensions</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                        
                    </div>

                    <h1 class="menu-title">PoE Format Specification</h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        
                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1><a class="header" href="#arm-layout" id="arm-layout">ARM Layout</a></h1>
<p>ARM files are line-based text files describing composable &quot;rooms&quot;. There are several variable-length lists where the length is derived from numbers occuring earlier in the file.</p>
<p>They describe a rectangular area filled with rectangular tiles of varying sizes and with a long list of per-tile attributes. There are also lists of things like doodads and decorative decals.</p>
<p>Examples below mostly taken from Glacier's <code>hideout.arm</code>.</p>
<h2><a class="header" href="#header" id="header">Header</a></h2>
<p>Literal <code>&quot;version&quot;</code> followed by integer, ex. <code>version 29</code>.</p>
<h2><a class="header" href="#entity-table" id="entity-table">Entity table</a></h2>
<p>Integer count followed by that many quoted strings.</p>
<h2><a class="header" href="#dimensions" id="dimensions">Dimensions?</a></h2>
<ul>
<li>v14-v21: Two integers, ex. <code>5 5</code>.</li>
<li>v22-v29: Three integers, ex. <code>27 27 1</code>.</li>
</ul>
<h2><a class="header" href="#counted-apa" id="counted-apa">Counted apa?</a></h2>
<p>Two integers, ex. <code>2 3</code>.</p>
<h2><a class="header" href="#name" id="name">Name?</a></h2>
<p>A possibly empty literal like <code>&quot;hideout&quot;</code>.</p>
<h2><a class="header" href="#bepa-table" id="bepa-table">Bepa table?</a></h2>
<p>v14-v15: Single integer.</p>
<p>v16+: Two integers.</p>
<h2><a class="header" href="#k-entry-solo" id="k-entry-solo">K-entry (solo)</a></h2>
<p>One k-entry <code>k 27 27 0 0 0 0 81 81 40 46 81 81 25 31 1 1 6 6 0 0 0 0 0 0</code>. The first two values indicate the width and the height of the whole thing.</p>
<p>The solo K-line has been observed to also be a <code>s</code> entry.</p>
<h2><a class="header" href="#apa-entries" id="apa-entries">Apa entries</a></h2>
<p><code>2 * (apa.0 + apa.1)</code> lines of integer pairs.</p>
<p>Followed by nine (v14) or six (v29) counted lists of various kinds of entities:</p>
<p>Integer count followed by a line like <code>364 482 0.872667 &quot;default&quot;</code>. X/Y/Z position + an identifier?</p>
<h2><a class="header" href="#k-lines" id="k-lines">K-lines</a></h2>
<p>Integer count of lines, which contains mixes of <code>f</code>, <code>k</code>, <code>n</code>, <code>o</code>, <code>s</code> and numbers at least <code>22</code> large.</p>
<ul>
<li><code>s</code> is probably empty or some sort of base;</li>
<li><code>n</code> is a filler tile that is covered by a larger <code>k</code> tile;</li>
<li><code>o</code> is unknown, appears in later versions;</li>
<li><code>f</code> is followed by a single number.</li>
</ul>
<p><code>k</code> is followed by 23 numbers in v14-v18; 24 numbers in v19-29. The first two are the dimensions of that k-tile, the rest are possibly negative numbers.</p>
<p>A <code>k</code>-tile of a size larger than 1x1 covers neighbouring <code>n</code>-tiles or may cover area outside of the width/height indicated in the solo k-entry.</p>
<p>In versions (v14-v18) lacking the 24ths field the <code>k</code>-tile covers tiles in +X and +Y directions.</p>
<p>In versions (v19+) the direction is indicated by the 24th field:</p>
<ul>
<li>0: +X and +Y, tile is in southwest corner of area - same as old versions;</li>
<li>1: -X and +Y, tile is in southeast corner of area;</li>
<li>2: -X and -Y, tile is in northeast corner of area;</li>
<li>3: +X and -Y, tile is in northwest corner of area.</li>
</ul>
<p>Example of line:</p>
<pre><code>k 1 1 0 0 0 0 3 3 3 3 3 3 3 3 1 1 1 1 0 0 0 0 0 0 k 1 1 0 0 0 0 3 3 3 3 3 3 3 3 1 1 1 1 0 0 0 0 0 0 k 1 1 0 0 0 0 3 3 3 3 3 3 3 3 1 1 1 1 0 0 0 0 0 0 k 1 1 0 0 0 0 3 3 3 3 3 3 3 3 1 1 1 1 0 0 0 0 0 0 k 1 1 0 0 0 0 3 3 3 3 3 3 3 3 1 1 1 1 0 0 0 0 0 0 k 1 1 0 0 0 0 3 3 3 3 3 3 3 3 1 1 1 1 0 0 0 0 0 0 k 3 3 5 5 0 0 4 9 4 9 9 9 9 9 1 0 1 1 0 0 0 0 0 0 n n k 3 9 0 14 8 14 9 9 4 22 8 9 4 22 0 0 0 0 0 0 0 0 15 0 n n k 3 3 5 0 0 5 4 9 9 9 9 9 4 9 0 1 1 1 0 0 0 0 0 0 n n k 1 1 0 0 0 0 3 3 3 3 3 3 3 3 1 1 1 1 0 0 0 0 0 0 k 1 1 0 0 0 0 3 3 3 3 3 3 3 3 1 1 1 1 0 0 0 0 0 0 k 1 1 0 0 0 0 3 3 3 3 3 3 3 3 1 1 1 1 0 0 0 0 0 0 k 1 1 0 0 0 0 3 3 3 3 3 3 3 3 1 1 1 1 0 0 0 0 0 0 k 1 1 0 0 0 0 3 3 3 3 3 3 3 3 1 1 1 1 0 0 0 0 0 0 k 1 1 0 0 0 0 3 3 3 3 3 3 3 3 1 1 1 1 0 0 0 0 0 0 k 1 1 0 0 0 0 3 3 3 3 3 3 3 3 1 1 1 1 0 0 0 0 0 0 k 1 1 0 0 0 0 3 3 3 3 3 3 3 3 1 1 1 1 0 0 0 0 0 0 k 1 1 0 0 0 0 3 3 3 3 3 3 3 3 1 1 1 1 0 0 0 0 0 0 k 1 1 0 0 0 0 3 3 3 3 3 3 3 3 1 1 1 1 0 0 0 0 0 0 k 1 1 0 0 0 0 3 3 3 3 3 3 3 3 1 1 1 1 0 0 0 0 0 0 k 1 1 0 0 0 0 3 3 3 3 3 3 3 3 1 1 1 1 0 0 0 0 0 0
</code></pre>
<h2><a class="header" href="#assorted-footer-lists" id="assorted-footer-lists">Assorted footer lists</a></h2>
<p>A sequence of counted lists follow, varying between versions.</p>
<p>v14:</p>
<ul>
<li>doodads</li>
<li>decals</li>
</ul>
<p>v15:</p>
<ul>
<li>doodads</li>
<li>decals</li>
<li>zero?</li>
</ul>
<p>v29:</p>
<ul>
<li>doodads</li>
<li>always zero?</li>
<li>decals</li>
<li>zero?</li>
<li>zero?</li>
<li>zero?</li>
</ul>
<h3><a class="header" href="#doodads" id="doodads">Doodads</a></h3>
<p>Integer count of lines, which contains a sequence of eleven numbers and two quoted strings, like:</p>
<pre><code>300 470 1.5708 -5.47648e-13 -1.23634e-07 0.707107 0.707107 0 0 0 1 &quot;Metadata/Terrain/Doodads/Encampment/guildstash_v01_01.ao&quot; &quot;Metadata/MiscellaneousObjects/GuildStash&quot;
609 330 -0 -0 0 -0 1 0 0 0 3.7 &quot;Metadata/Terrain/Doodads/Tools/invisible_blocker.ao&quot; &quot;Metadata/MiscellaneousObjects/Doodad&quot;
</code></pre>
<p>The first two numbers seems to be integers, followed by three reals in scientific notation, where the first number often is pi or half-pi. 
This is followed by a pair of numbers whose magnitude is around 1, probably an 2D orientation.</p>
<p>Finally three numbers (always 0 thus far) occur, followed by a single real that's often 1 but sometimes small values like 3.7.</p>
<h3><a class="header" href="#decals" id="decals">Decals</a></h3>
<p>To be described.</p>
<h3><a class="header" href="#trailing-line" id="trailing-line">Trailing line</a></h3>
<p>A line that often but not always has a number of elements that is related to the k-area extents like (width - 1) * (height - 1), that's to say, the number of 4-connections between tiles.</p>
<p>It's often as sequence of small integers - typically zero and one more than the number of gtets.
Sometimes this line has a lot of quoted strings - typically empty and sometimes with short contents.
Sometimes this line has twice the number of elements and then has the strings first and numbers later.
In some rare case the line has a few more elements than the predicted extents.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        
                            <a rel="prev" href="ggpk.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        

                        
                            <a rel="next" href="ao-aoc.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                
                    <a rel="prev" href="ggpk.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                

                
                    <a rel="next" href="ao-aoc.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                
            </nav>

        </div>

        

        

        

        
        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        

        

        
        <script src="elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        

        

    </body>
</html>
